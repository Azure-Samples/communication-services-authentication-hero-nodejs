# React single-page application built with MSAL React and Microsoft identity platform to demonstrate the Azure Communication Services Auth sample

This is a very simple client based on the autogenerated react single page app from the Microsoft Entra registered apps QuickStart. This should not be used for production and serves as a sample to see how the backend can be called.

## Prerequisites

- Backend server set up and running. (If deployed to a non-local environment, modify `SERVER_ADDRESS` in [acsAuthApiCaller.js](../MinimalClient/src/acsAuthApiCaller.js))
- Single page client app registered on Microsoft Entra ID.
- Populate the [authConfig.js](../MinimalClient/src/authConfig.js) file with the `clientId`, `authority`, and `redirectUri` values from the client app registration.

## Running the client

1. Run `npm install`
1. Run `npm start`
1. Navigate to [http://localhost:3000/](http://localhost:3000/)

## Joining a group call as a Communication Identity

1. Click **Sign in** and use the login dialog to log in with a valid Microsoft Entra identity.
1. Click **Join Default Call** to join a call using the displayed randomly generated GUID, or use the **Microsoft Entra Access Token** to directly call the backend API.
1. To join a call with another device, share the GUID and enter it in the text box of the client wanting to join the same call.

## Joining a Teams meeting as a Teams user

1. Click **Sign in as a Teams user** then use the login dialog to log in with an Microsoft Entra identity with a valid Teams license.
1. Fill in the **Teams Meeting Link** with the link to the meeting you want to join.
1. Click **Join as a Teams user** to join the specified meeting.
1. Alternatively, you can call the `GET /api/token/teams` endpoint with the Microsoft Entra Access Token in the `Authorization: Bearer <token>` header and the Microsoft Entra Token for a Teams user in the `teams-user-aad-token` header to generate a valid Communication Token.
1. Or use the generated **Communication Token** to directly call the Calling API.
